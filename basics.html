<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Basics &mdash; MDAnalysis Tutorial 0.1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis Tutorial 0.1.1 documentation" href="index.html" />
    <link rel="next" title="Working with AtomGroups" href="atomgroups.html" />
    <link rel="prev" title="Preparations" href="preparations.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="atomgroups.html" title="Working with AtomGroups"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="preparations.html" title="Preparations"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">MDAnalysis Tutorial 0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/mdanalysistutorial-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Basics</a><ul>
<li><a class="reference internal" href="#universe-and-atomgroup">Universe and AtomGroup</a><ul>
<li><a class="reference internal" href="#exercise-1">Exercise 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#selections">Selections</a><ul>
<li><a class="reference internal" href="#exercises-2">Exercises 2</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="preparations.html"
                        title="previous chapter">Preparations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="atomgroups.html"
                        title="next chapter">Working with AtomGroups</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/basics.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="basics">
<h1>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h1>
<p>We discuss the fundamental objects in MDAnalysis, the
<a class="reference internal" href="#universe-and-atomgroup"><em>Universe and AtomGroup</em></a>, and the facilities for
<a class="reference internal" href="#selections"><em>Selections</em></a> of atoms. These selections themselves are again an
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></tt></a>.</p>
<div class="section" id="universe-and-atomgroup">
<span id="id1"></span><h2>Universe and AtomGroup<a class="headerlink" href="#universe-and-atomgroup" title="Permalink to this headline">¶</a></h2>
<p>MDAnalysis is <strong>object oriented</strong>. Molecular systems consist of
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Atom" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> objects (instances of the
class <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Atom" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.AtomGroup.Atom</span></tt></a>), which are grouped in
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></tt></a> instances. You build the
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></tt></a> of your system by
loading a <strong>topology</strong> (list of atoms and possibly their connectivity)
together with a <strong>trajectory</strong> (coordinate information) into the
central data structure, the
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Universe</span></tt></a> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">&lt;Universe with 3341 atoms&gt;</span>
</pre></div>
</div>
<p>The atoms are stored in the attribute
<tt class="xref py py-attr docutils literal"><span class="pre">atoms</span></tt> of the
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.AtomGroup.Universe</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="go">&lt;AtomGroup with 3341 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[&lt; Atom 1: name &#39;N&#39; of type &#39;56&#39; of resname &#39;MET&#39;, resid 1 and segid &#39;4AKE&#39;&gt;,</span>
<span class="go"> &lt; Atom 2: name &#39;HT1&#39; of type &#39;2&#39; of resname &#39;MET&#39;, resid 1 and segid &#39;4AKE&#39;&gt;,</span>
<span class="go"> &lt; Atom 3: name &#39;HT2&#39; of type &#39;2&#39; of resname &#39;MET&#39;, resid 1 and segid &#39;4AKE&#39;&gt;,</span>
<span class="go"> &lt; Atom 4: name &#39;HT3&#39; of type &#39;2&#39; of resname &#39;MET&#39;, resid 1 and segid &#39;4AKE&#39;&gt;,</span>
<span class="go"> &lt; Atom 5: name &#39;CA&#39; of type &#39;22&#39; of resname &#39;MET&#39;, resid 1 and segid &#39;4AKE&#39;&gt;]</span>
</pre></div>
</div>
<p>Any <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></tt></a> knows the residues
that the atoms belong to via the attribute
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.residues" title="(in MDAnalysis v0.8)"><tt class="xref py py-attr docutils literal"><span class="pre">residues</span></tt></a>, which produces a
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.ResidueGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></tt></a>. A
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.ResidueGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></tt></a> acts like a list of
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Residue" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a> objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">130</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span>
<span class="go">&lt;ResidueGroup [&lt;Residue &#39;LEU&#39;, 6&gt;, &lt;Residue &#39;GLY&#39;, 7&gt;, &lt;Residue &#39;ALA&#39;, 8&gt;]&gt;</span>
</pre></div>
</div>
<p>Larger organizational units are
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Segment" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Segment</span></tt></a> instances, for example one
protein or all the solvent molecules or simply the whole
system. <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Atom" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a>,
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></tt></a>,
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Residue" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a>, and
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.ResidueGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></tt></a> have an
attribute <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.segments" title="(in MDAnalysis v0.8)"><tt class="xref py py-attr docutils literal"><span class="pre">segments</span></tt></a> that
will list the segment IDs (&#8220;segids&#8221;) as a
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.SegmentGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">SegmentGroup</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">segments</span>
<span class="go">&lt;SegmentGroup [&lt;Segment &#39;4AKE&#39;&gt;]&gt;</span>
</pre></div>
</div>
<p>The converse is also true: each &#8220;higher&#8221; level in the hierarchy also
know about the <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Residue" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a> and
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Atom" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Atom</span></tt></a> instances it contains. For
example, to list the atoms of the
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.ResidueGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></tt></a> we had before:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">130</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">atoms</span>
<span class="go">&lt;AtomGroup with 36 atoms&gt;</span>
</pre></div>
</div>
<div class="section" id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">What residue (&#8220;resname&#8221;) does the last atom belong to in the above
example?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">130</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&lt; Atom 136: name &#39;O&#39; of type &#39;70&#39; of resname &#39;ALA&#39;, resid 8 and segid &#39;4AKE&#39;&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Why does the expression</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">130</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">130</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
</pre></div>
</div>
<p>return <tt class="docutils literal"><span class="pre">False</span></tt>?</p>
<p>Because the complete residues contain more atoms than the arbitrary
slice of atoms.</p>
</li>
<li><p class="first">How many residues are in the
<tt class="xref py py-class docutils literal"><span class="pre">Universe</span></tt> <tt class="docutils literal"><span class="pre">u</span></tt>?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">numberOfResidues</span><span class="p">()</span>
<span class="go">214</span>
</pre></div>
</div>
<p>How do you get a list of the residue names (such as <tt class="docutils literal"><span class="pre">[&quot;Ala&quot;,</span>
<span class="pre">&quot;Gly&quot;,</span> <span class="pre">&quot;Gly&quot;,</span> <span class="pre">&quot;Asp&quot;,</span> <span class="pre">...]</span></tt>) and residue numbers (&#8220;resid&#8221;) for
atoms 1000 to 1300? And as a list of tuples <tt class="docutils literal"><span class="pre">(resname,</span> <span class="pre">resid)</span></tt>
(Hint: <a class="reference external" href="http://docs.python.org/library/functions.html#zip" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">zip()</span></tt></a>)?:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">resnames</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">999</span><span class="p">:</span><span class="mi">1300</span><span class="p">]</span><span class="o">.</span><span class="n">resnames</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resids</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">999</span><span class="p">:</span><span class="mi">1300</span><span class="p">]</span><span class="o">.</span><span class="n">resids</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">zip</span><span class="p">(</span><span class="n">resnames</span><span class="p">,</span> <span class="n">resids</span><span class="p">)</span>
</pre></div>
</div>
<p>How do you obtain the resid and the resname for the 100th residue?
(Hint: investigate the <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Residue" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Residue</span></tt></a>
object interactively with <tt class="kbd docutils literal"><span class="pre">TAB</span></tt> completion)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r100</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">99</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">r100</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">r100</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">100 GLY</span>
</pre></div>
</div>
</li>
<li><p class="first">How many segments are there?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">segments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">numberOfSegments</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>What is the segment identifier of the first
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Segment" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Segment</span></tt></a>?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">id</span>
<span class="go">&#39;4AKE&#39;</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Methods of <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></tt></a>,
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.ResidueGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></tt></a>, and
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.SegmentGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">SegmentGroup</span></tt></a></p>
<ul class="last simple">
<li><a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.numberOfResidues" title="(in MDAnalysis v0.8)"><tt class="xref py py-meth docutils literal"><span class="pre">numberOfResidues()</span></tt></a> and
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.numberOfAtoms" title="(in MDAnalysis v0.8)"><tt class="xref py py-meth docutils literal"><span class="pre">numberOfAtoms()</span></tt></a></li>
<li><a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.resids" title="(in MDAnalysis v0.8)"><tt class="xref py py-meth docutils literal"><span class="pre">resids()</span></tt></a></li>
<li><a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.resnames" title="(in MDAnalysis v0.8)"><tt class="xref py py-meth docutils literal"><span class="pre">resnames()</span></tt></a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="selections">
<span id="id2"></span><h2>Selections<a class="headerlink" href="#selections" title="Permalink to this headline">¶</a></h2>
<p>MDAnalysis comes with a fairly complete <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/selections.html">atom selection</a>
facility. Primarily, one uses the method
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe.selectAtoms" title="(in MDAnalysis v0.8)"><tt class="xref py py-meth docutils literal"><span class="pre">selectAtoms()</span></tt></a> of a
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">Universe</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">CA</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;protein and name CA&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">&lt;</span><span class="n">AtomGroup</span> <span class="k">with</span> <span class="mi">214</span> <span class="n">atoms</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>but really any <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="(in MDAnalysis v0.8)"><tt class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></tt></a> has a
<a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.selectAtoms" title="(in MDAnalysis v0.8)"><tt class="xref py py-meth docutils literal"><span class="pre">selectAtoms()</span></tt></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">acidic</span> <span class="o">=</span> <span class="n">CA</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;resname ASP or resname GLU&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acidic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">&lt;</span><span class="n">AtomGroup</span> <span class="k">with</span> <span class="mi">35</span> <span class="n">atoms</span><span class="o">&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acidic</span><span class="o">.</span><span class="n">residues</span>
<span class="go">&lt;ResidueGroup [&lt;Residue &#39;GLU&#39;, 22&gt;, &lt;Residue &#39;ASP&#39;, 33&gt;, &lt;Residue &#39;GLU&#39;, 44&gt;, &lt;Residue &#39;ASP&#39;, 51&gt;, &lt;Residue &#39;ASP&#39;, 54&gt;, &lt;Residue &#39;ASP&#39;, 61&gt;, &lt;Residue &#39;GLU&#39;, 62&gt;, &lt;Residue &#39;GLU&#39;, 70&gt;, &lt;Residue &#39;GLU&#39;, 75&gt;, &lt;Residue &#39;ASP&#39;, 76&gt;, &lt;Residue &#39;ASP&#39;, 84&gt;, &lt;Residue &#39;ASP&#39;, 94&gt;, &lt;Residue &#39;GLU&#39;, 98&gt;, &lt;Residue &#39;ASP&#39;, 104&gt;, &lt;Residue &#39;GLU&#39;, 108&gt;, &lt;Residue &#39;ASP&#39;, 110&gt;, &lt;Residue &#39;ASP&#39;, 113&gt;, &lt;Residue &#39;GLU&#39;, 114&gt;, &lt;Residue &#39;ASP&#39;, 118&gt;, &lt;Residue &#39;GLU&#39;, 143&gt;, &lt;Residue &#39;ASP&#39;, 146&gt;, &lt;Residue &#39;ASP&#39;, 147&gt;, &lt;Residue &#39;GLU&#39;, 151&gt;, &lt;Residue &#39;GLU&#39;, 152&gt;, &lt;Residue &#39;ASP&#39;, 158&gt;, &lt;Residue &#39;ASP&#39;, 159&gt;, &lt;Residue &#39;GLU&#39;, 161&gt;, &lt;Residue &#39;GLU&#39;, 162&gt;, &lt;Residue &#39;GLU&#39;, 170&gt;, &lt;Residue &#39;GLU&#39;, 185&gt;, &lt;Residue &#39;GLU&#39;, 187&gt;, &lt;Residue &#39;ASP&#39;, 197&gt;, &lt;Residue &#39;GLU&#39;, 204&gt;, &lt;Residue &#39;ASP&#39;, 208&gt;, &lt;Residue &#39;GLU&#39;, 210&gt;]&gt;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">All the <a class="reference external" href="http://pythonhosted.org/MDAnalysis/documentation_pages/selections.html#selection-keywords">selection keywords</a> are described in the documentation.</p>
</div>
<p>Selections can be combined with boolean expression and it is also
possible to select by geometric criteria, e.g. with the <tt class="samp docutils literal"><span class="pre">around</span>
<em><span class="pre">distance</span></em> <em><span class="pre">selection</span></em></tt> keyword:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;((resname ASP or resname GLU) and not (backbone or name CB or name CG)) </span><span class="se">\</span>
<span class="s">                 and around 4.0 ((resname LYS or resname ARG) </span><span class="se">\</span>
<span class="s">                                  and not (backbone or name CB or name CG))&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span>
</pre></div>
</div>
<p>This selection will find atoms potentially involved in salt bridges
between acidic and basic residues.</p>
<div class="section" id="exercises-2">
<h3>Exercises 2<a class="headerlink" href="#exercises-2" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Select the range of resids 100 to 200 (&#8220;100-200&#8221;) with a
selection. Compare the result to what you get by slicing the
<tt class="xref py py-attr docutils literal"><span class="pre">u.atoms.residues</span></tt> appropriately.</p>
<p>Which approach would you prefer to use in a analysis script?</p>
<p>Solution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;resid 100-200&quot;</span><span class="p">)</span>
<span class="go">&lt;AtomGroup with 1609 atoms&gt;</span>
</pre></div>
</div>
<p>Compare to the slicing solution (doing an element-wise comparison,
i.e. residue by residue in each <tt class="xref py py-func docutils literal"><span class="pre">list()</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;resid 100-200&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">99</span><span class="p">:</span><span class="mi">200</span><span class="p">])</span>
</pre></div>
</div>
<p>If one wants to get specific residues in scripts one typically uses
selections instead of slicing because the index in the slice might
not correspond to the actual residue ids (minus 1): If a number of
residues (e.g. 150-160) are missing from the structure then the
selection will simply give you residues 100-149 and 151-200 but the
slice 99:200 would give you residues 100-149 and <em>161-209</em>.</p>
</li>
<li><p class="first">Select all residues that do not contain a <span class="math">\(\mathrm{C}_\beta\)</span>
(&#8220;CB&#8221;) atom. How many are there? What residue names did you find?</p>
<p>Solution:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;(byres name CA) and not (byres name CB)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
<span class="go">20</span>
</pre></div>
</div>
<p>These are all Glycines, as can be seen by comparing the residue
groups element-wise:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">glycines</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;resname GLY&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">glycines</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="atomgroups.html" title="Working with AtomGroups"
             >next</a> |</li>
        <li class="right" >
          <a href="preparations.html" title="Preparations"
             >previous</a> |</li>
        <li><a href="index.html">MDAnalysis Tutorial 0.1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>